

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>medsegpy.modeling.layers &mdash; MedSegPy 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'0.0.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="medsegpy.solver" href="solver.html" />
    <link rel="prev" title="medsegpy.evaluation" href="evaluation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MedSegPy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">medsegpy.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="engine.html">medsegpy.engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation.html">medsegpy.evaluation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">medsegpy.modeling.layers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-medsegpy.modeling.layers.attention">medsegpy.modeling.layers.attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-medsegpy.modeling.layers.pooling">medsegpy.modeling.layers.pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#medsegpy-modeling-layers-upsampling">medsegpy.modeling.layers.upsampling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#medsegpy-modeling-meta-arch">medsegpy.modeling.meta_arch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-medsegpy.modeling.meta_arch.build">medsegpy.modeling.meta_arch.build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-medsegpy.modeling.meta_arch.deeplabv3">medsegpy.modeling.meta_arch.deeplabv3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-medsegpy.modeling.meta_arch.unet">medsegpy.modeling.meta_arch.unet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="solver.html">medsegpy.solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">medsegpy.utils</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MedSegPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Documentation</a> &raquo;</li>
        
      <li>medsegpy.modeling.layers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/modeling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="medsegpy-modeling-layers">
<h1>medsegpy.modeling.layers<a class="headerlink" href="#medsegpy-modeling-layers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-medsegpy.modeling.layers.attention">
<span id="medsegpy-modeling-layers-attention"></span><h2>medsegpy.modeling.layers.attention<a class="headerlink" href="#module-medsegpy.modeling.layers.attention" title="Permalink to this headline">¶</a></h2>
<p>Attention Layers</p>
<p>The following layers implement an attention gating module based on the
paper “Attention U-Net: Learning Where to Look For the Pancreas”
(Oktay et al.). The code below is based on a PyTorch implementation of
this technique by the paper’s authors:</p>
<p><a class="reference external" href="https://github.com/ozan-oktay/Attention-Gated-Networks/tree/a96edb72622274f6705097d70cfaa7f2bf818a5a">https://github.com/ozan-oktay/Attention-Gated-Networks/tree/a96edb72622274f6705097d70cfaa7f2bf818a5a</a></p>
<p>Each layer has 2D and 3D versions. Only the 2D versions have been tested
so far.</p>
<dl class="class">
<dt id="medsegpy.modeling.layers.attention.CreateGatingSignal2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">CreateGatingSignal2D</code><span class="sig-paren">(</span><em>out_channels: int</em>, <em>kernel_size: Union[int</em>, <em>typing.Sequence[int]] = 1</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>activation: str = 'relu'</em>, <em>add_batchnorm: bool = True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#CreateGatingSignal2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.CreateGatingSignal2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.CreateGatingSignal3D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">CreateGatingSignal3D</code><span class="sig-paren">(</span><em>out_channels: int</em>, <em>kernel_size: Union[int</em>, <em>typing.Sequence[int]] = 1</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>activation: str = 'relu'</em>, <em>add_batchnorm: bool = True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#CreateGatingSignal3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.CreateGatingSignal3D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.GridAttentionModule2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">GridAttentionModule2D</code><span class="sig-paren">(</span><em>in_channels: int</em>, <em>intermediate_channels: int</em>, <em>sub_sample_factor: Union[int</em>, <em>typing.Sequence[int]] = 2</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#GridAttentionModule2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.GridAttentionModule2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.GridAttentionModule3D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">GridAttentionModule3D</code><span class="sig-paren">(</span><em>in_channels: int</em>, <em>intermediate_channels: int</em>, <em>sub_sample_factor: Union[int</em>, <em>typing.Sequence[int]] = 2</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#GridAttentionModule3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.GridAttentionModule3D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.MultiAttentionModule2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">MultiAttentionModule2D</code><span class="sig-paren">(</span><em>in_channels: int</em>, <em>intermediate_channels: int</em>, <em>sub_sample_factor: Union[int</em>, <em>typing.Sequence[int]] = 2</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>activation: str = 'relu'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#MultiAttentionModule2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.MultiAttentionModule2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.MultiAttentionModule3D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">MultiAttentionModule3D</code><span class="sig-paren">(</span><em>in_channels: int</em>, <em>intermediate_channels: int</em>, <em>sub_sample_factor: Union[int</em>, <em>typing.Sequence[int]] = 2</em>, <em>kernel_initializer: Union[str</em>, <em>typing.Dict] = 'he_normal'</em>, <em>activation: str = 'relu'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#MultiAttentionModule3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.MultiAttentionModule3D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.DeepSupervision2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">DeepSupervision2D</code><span class="sig-paren">(</span><em>out_channels: int, scale_factor: Union[int, typing.Sequence[int]], kernel_initializer: Union[str, typing.Dict] = 'he_normal', **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#DeepSupervision2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.DeepSupervision2D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.attention.DeepSupervision3D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.attention.</code><code class="descname">DeepSupervision3D</code><span class="sig-paren">(</span><em>out_channels: int, scale_factor: Union[int, typing.Sequence[int]], kernel_initializer: Union[str, typing.Dict] = 'he_normal', **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/attention.html#DeepSupervision3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.attention.DeepSupervision3D" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-medsegpy.modeling.layers.pooling">
<span id="medsegpy-modeling-layers-pooling"></span><h2>medsegpy.modeling.layers.pooling<a class="headerlink" href="#module-medsegpy.modeling.layers.pooling" title="Permalink to this headline">¶</a></h2>
<p>Pooling layers.</p>
<p>MaxPoolingMask2D, MaxPoolingWithArgmax2D, and MaxUnpooling2D are based on are
based on code from the open-source repo below. We thank the authors for making
the code publicly available.</p>
<p><a class="reference external" href="https://github.com/ykamikawa/tf-keras-SegNet/tree/648ee1aa6870e8280a5f24ee193caa585adde9cd">https://github.com/ykamikawa/tf-keras-SegNet/tree/648ee1aa6870e8280a5f24ee193caa585adde9cd</a>.</p>
<dl class="class">
<dt id="medsegpy.modeling.layers.pooling.MaxPooling2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.pooling.</code><code class="descname">MaxPooling2D</code><span class="sig-paren">(</span><em>pool_size=(2</em>, <em>2)</em>, <em>strides=None</em>, <em>padding='valid'</em>, <em>data_format=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensorflow/python/keras/layers/pooling.html#MaxPooling2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.pooling.MaxPooling2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Max pooling operation for 2D spatial data.</p>
<p>Downsamples the input representation by taking the maximum value over the
window defined by <cite>pool_size</cite> for each dimension along the features axis.
The window is shifted by <cite>strides</cite> in each dimension.  The resulting output
when using “valid” padding option has a shape(number of rows or columns) of:
<cite>output_shape = (input_shape - pool_size + 1) / strides)</cite></p>
<p>The resulting output shape when using the “same” padding option is:
<cite>output_shape = input_shape / strides</cite></p>
<p>For example, for stride=(1,1) and padding=”valid”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;tf.Tensor: shape=(1, 2, 2, 1), dtype=float32, numpy=</span>
<span class="go">  array([[[[5.],</span>
<span class="go">           [6.]],</span>
<span class="go">          [[8.],</span>
<span class="go">           [9.]]]], dtype=float32)&gt;</span>
</pre></div>
</div>
<p>For example, for stride=(2,2) and padding=”valid”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">11.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;tf.Tensor: shape=(1, 2, 3, 1), dtype=float32, numpy=</span>
<span class="go">  array([[[[ 6.],</span>
<span class="go">           [ 7.],</span>
<span class="go">           [ 8.]],</span>
<span class="go">          [[10.],</span>
<span class="go">           [11.],</span>
<span class="go">           [12.]]]], dtype=float32)&gt;</span>
</pre></div>
</div>
<p>Usage Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[[[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">]],</span>
<span class="gp">... </span>                           <span class="p">[[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">]],</span>
<span class="gp">... </span>                           <span class="p">[[</span><span class="mf">4.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]],</span>
<span class="gp">... </span>                           <span class="p">[[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                      <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_image</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([[[[2.],</span>
<span class="go">         [4.]],</span>
<span class="go">        [[4.],</span>
<span class="go">         [4.]]]], dtype=float32)</span>
</pre></div>
</div>
<p>For example, for stride=(1,1) and padding=”same”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">],</span>
<span class="gp">... </span>                 <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>   <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_pool_2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;tf.Tensor: shape=(1, 3, 3, 1), dtype=float32, numpy=</span>
<span class="go">  array([[[[5.],</span>
<span class="go">           [6.],</span>
<span class="go">           [6.]],</span>
<span class="go">          [[8.],</span>
<span class="go">           [9.],</span>
<span class="go">           [9.]],</span>
<span class="go">          [[8.],</span>
<span class="go">           [9.],</span>
<span class="go">           [9.]]]], dtype=float32)&gt;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pool_size</strong> – integer or tuple of 2 integers,
window size over which to take the maximum.
<cite>(2, 2)</cite> will take the max value over a 2x2 pooling window.
If only one integer is specified, the same window length
will be used for both dimensions.</li>
<li><strong>strides</strong> – Integer, tuple of 2 integers, or None.
Strides values.  Specifies how far the pooling window moves
for each pooling step. If None, it will default to <cite>pool_size</cite>.</li>
<li><strong>padding</strong> – One of <cite>“valid”</cite> or <cite>“same”</cite> (case-insensitive).
“valid” adds no zero padding.  “same” adds padding such that if the stride
is 1, the output shape is the same as input shape.</li>
<li><strong>data_format</strong> – A string,
one of <cite>channels_last</cite> (default) or <cite>channels_first</cite>.
The ordering of the dimensions in the inputs.
<cite>channels_last</cite> corresponds to inputs with shape
<cite>(batch, height, width, channels)</cite> while <cite>channels_first</cite>
corresponds to inputs with shape
<cite>(batch, channels, height, width)</cite>.
It defaults to the <cite>image_data_format</cite> value found in your
Keras config file at <cite>~/.keras/keras.json</cite>.
If you never set it, then it will be “channels_last”.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Input shape:</dt>
<dd><ul class="first last simple">
<li>If <cite>data_format=’channels_last’</cite>:
4D tensor with shape <cite>(batch_size, rows, cols, channels)</cite>.</li>
<li>If <cite>data_format=’channels_first’</cite>:
4D tensor with shape <cite>(batch_size, channels, rows, cols)</cite>.</li>
</ul>
</dd>
<dt>Output shape:</dt>
<dd><ul class="first last simple">
<li>If <cite>data_format=’channels_last’</cite>:
4D tensor with shape <cite>(batch_size, pooled_rows, pooled_cols, channels)</cite>.</li>
<li>If <cite>data_format=’channels_first’</cite>:
4D tensor with shape <cite>(batch_size, channels, pooled_rows, pooled_cols)</cite>.</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A tensor of rank 4 representing the maximum pooled values.  See above for
output shape.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="medsegpy.modeling.layers.pooling.UpSampling2D">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.pooling.</code><code class="descname">UpSampling2D</code><span class="sig-paren">(</span><em>size=(2</em>, <em>2)</em>, <em>data_format=None</em>, <em>interpolation='nearest'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tensorflow/python/keras/layers/convolutional.html#UpSampling2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.pooling.UpSampling2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Upsampling layer for 2D inputs.</p>
<p>Repeats the rows and columns of the data
by <cite>size[0]</cite> and <cite>size[1]</cite> respectively.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">input_shape</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[[[[ 0  1  2]]</span>
<span class="go">  [[ 3  4  5]]]</span>
<span class="go"> [[[ 6  7  8]]</span>
<span class="go">  [[ 9 10 11]]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">UpSampling2D</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">tf.Tensor(</span>
<span class="go">  [[[[ 0  1  2]</span>
<span class="go">     [ 0  1  2]]</span>
<span class="go">    [[ 3  4  5]</span>
<span class="go">     [ 3  4  5]]]</span>
<span class="go">   [[[ 6  7  8]</span>
<span class="go">     [ 6  7  8]]</span>
<span class="go">    [[ 9 10 11]</span>
<span class="go">     [ 9 10 11]]]], shape=(2, 2, 2, 3), dtype=int64)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>size</strong> – Int, or tuple of 2 integers.
The upsampling factors for rows and columns.</li>
<li><strong>data_format</strong> – A string,
one of <cite>channels_last</cite> (default) or <cite>channels_first</cite>.
The ordering of the dimensions in the inputs.
<cite>channels_last</cite> corresponds to inputs with shape
<cite>(batch_size, height, width, channels)</cite> while <cite>channels_first</cite>
corresponds to inputs with shape
<cite>(batch_size, channels, height, width)</cite>.
It defaults to the <cite>image_data_format</cite> value found in your
Keras config file at <cite>~/.keras/keras.json</cite>.
If you never set it, then it will be “channels_last”.</li>
<li><strong>interpolation</strong> – A string, one of <cite>nearest</cite> or <cite>bilinear</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Input shape:</dt>
<dd><p class="first">4D tensor with shape:
- If <cite>data_format</cite> is <cite>“channels_last”</cite>:</p>
<blockquote>
<div><cite>(batch_size, rows, cols, channels)</cite></div></blockquote>
<ul class="last simple">
<li><dl class="first docutils">
<dt>If <cite>data_format</cite> is <cite>“channels_first”</cite>:</dt>
<dd><cite>(batch_size, channels, rows, cols)</cite></dd>
</dl>
</li>
</ul>
</dd>
<dt>Output shape:</dt>
<dd><p class="first">4D tensor with shape:
- If <cite>data_format</cite> is <cite>“channels_last”</cite>:</p>
<blockquote>
<div><cite>(batch_size, upsampled_rows, upsampled_cols, channels)</cite></div></blockquote>
<ul class="last simple">
<li><dl class="first docutils">
<dt>If <cite>data_format</cite> is <cite>“channels_first”</cite>:</dt>
<dd><cite>(batch_size, channels, upsampled_rows, upsampled_cols)</cite></dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="medsegpy-modeling-layers-upsampling">
<h2>medsegpy.modeling.layers.upsampling<a class="headerlink" href="#medsegpy-modeling-layers-upsampling" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-medsegpy.modeling.layers.upsampling"></span><p>Deeplabv3+ model for Keras.
This model is based on TF repo:
<a class="reference external" href="https://github.com/tensorflow/models/tree/master/research/deeplab">https://github.com/tensorflow/models/tree/master/research/deeplab</a>
On Pascal VOC, original model gets to 84.56% mIOU</p>
<p>Now this model is only available for the TensorFlow backend,
due to its reliance on <cite>SeparableConvolution</cite> layers, but Theano will add
this layer soon.</p>
<p>MobileNetv2 backbone is based on this repo:
<a class="reference external" href="https://github.com/JonathanCMitchell/mobilenet_v2_keras">https://github.com/JonathanCMitchell/mobilenet_v2_keras</a></p>
<p># Reference
- [Encoder-Decoder with Atrous Separable Convolution</p>
<blockquote>
<div>for Semantic Image Segmentation](<a class="reference external" href="https://arxiv.org/pdf/1802.02611.pdf">https://arxiv.org/pdf/1802.02611.pdf</a>)</div></blockquote>
<ul class="simple">
<li><dl class="first docutils">
<dt>[Xception: Deep Learning with Depthwise Separable Convolutions]</dt>
<dd>(<a class="reference external" href="https://arxiv.org/abs/1610.02357">https://arxiv.org/abs/1610.02357</a>)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>[Inverted Residuals and Linear Bottlenecks: Mobile Networks for</dt>
<dd>Classification, Detection and Segmentation](<a class="reference external" href="https://arxiv.org/abs/1801.04381">https://arxiv.org/abs/1801.04381</a>)</dd>
</dl>
</li>
</ul>
<dl class="class">
<dt id="medsegpy.modeling.layers.upsampling.BilinearUpsampling">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.layers.upsampling.</code><code class="descname">BilinearUpsampling</code><span class="sig-paren">(</span><em>upsampling=(2</em>, <em>2)</em>, <em>output_size=None</em>, <em>data_format=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/layers/upsampling.html#BilinearUpsampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.layers.upsampling.BilinearUpsampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Just a simple bilinear upsampling layer. Works only with TF.
:param upsampling: tuple of 2 numbers &gt; 0. The upsampling ratio for h and w
:param output_size: used instead of upsampling arg if passed!</p>
</dd></dl>

</div>
</div>
<div class="section" id="medsegpy-modeling-meta-arch">
<h1>medsegpy.modeling.meta_arch<a class="headerlink" href="#medsegpy-modeling-meta-arch" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-medsegpy.modeling.meta_arch.build">
<span id="medsegpy-modeling-meta-arch-build"></span><h2>medsegpy.modeling.meta_arch.build<a class="headerlink" href="#module-medsegpy.modeling.meta_arch.build" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medsegpy.modeling.meta_arch.build.build_model">
<code class="descclassname">medsegpy.modeling.meta_arch.build.</code><code class="descname">build_model</code><span class="sig-paren">(</span><em>cfg</em>, <em>input_tensor=None</em><span class="sig-paren">)</span> &#x2192; medsegpy.modeling.model.Model<a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/build.html#build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.build.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the whole model architecture, defined by <code class="docutils literal notranslate"><span class="pre">cfg.MODEL_NAME</span></code>.
Note that it does not load any weights from <code class="docutils literal notranslate"><span class="pre">cfg</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="module-medsegpy.modeling.meta_arch.deeplabv3">
<span id="medsegpy-modeling-meta-arch-deeplabv3"></span><h2>medsegpy.modeling.meta_arch.deeplabv3<a class="headerlink" href="#module-medsegpy.modeling.meta_arch.deeplabv3" title="Permalink to this headline">¶</a></h2>
<p>DeeplabV3+ implementation.</p>
<p>This model is based on TF and Keras repos below:
<a class="reference external" href="https://github.com/tensorflow/models/tree/master/research/deeplab">https://github.com/tensorflow/models/tree/master/research/deeplab</a>
<a class="reference external" href="https://github.com/bonlime/keras-deeplab-v3-plus">https://github.com/bonlime/keras-deeplab-v3-plus</a></p>
<dl class="class">
<dt id="medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus">
<em class="property">class </em><code class="descclassname">medsegpy.modeling.meta_arch.deeplabv3.</code><code class="descname">DeeplabV3Plus</code><span class="sig-paren">(</span><em>cfg: medsegpy.config.DeeplabV3Config</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/deeplabv3.html#DeeplabV3Plus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.sep_conv_bn">
<code class="descname">sep_conv_bn</code><span class="sig-paren">(</span><em>x</em>, <em>filters</em>, <em>prefix</em>, <em>stride=1</em>, <em>kernel_size=3</em>, <em>rate=1</em>, <em>depth_activation=False</em>, <em>epsilon=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/deeplabv3.html#DeeplabV3Plus.sep_conv_bn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.sep_conv_bn" title="Permalink to this definition">¶</a></dt>
<dd><p>SepConv with BN between depthwise &amp; pointwise.</p>
<p>Optionally add activation after BN.
Implements right “same” padding for even kernel sizes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> – input tensor</li>
<li><strong>filters</strong> – num of filters in pointwise convolution</li>
<li><strong>prefix</strong> – prefix before name</li>
<li><strong>stride</strong> – stride at depthwise conv</li>
<li><strong>kernel_size</strong> – kernel size for depthwise convolution</li>
<li><strong>rate</strong> – atrous rate for depthwise convolution</li>
<li><strong>depth_activation</strong> – flag to use activation between depthwise &amp;
pointwise convs</li>
<li><strong>epsilon</strong> – epsilon to use in BN layer</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.deeplabv3">
<code class="descname">deeplabv3</code><span class="sig-paren">(</span><em>input_tensor=None</em>, <em>input_shape=(512</em>, <em>512</em>, <em>3)</em>, <em>classes=21</em>, <em>backbone='mobilenetv2'</em>, <em>OS=16</em>, <em>alpha=1.0</em>, <em>dilation_divisor=1</em>, <em>dil_rate_input=None</em>, <em>dropout_rate=0.1</em><span class="sig-paren">)</span> &#x2192; medsegpy.modeling.model.Model<a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/deeplabv3.html#DeeplabV3Plus.deeplabv3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.deeplabv3" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates the Deeplabv3+ architecture</p>
<p>Optionally loads weights pre-trained
on PASCAL VOC. This model is available for TensorFlow only,
and can only be used with inputs following the TensorFlow
data format <cite>(width, height, channels)</cite>.
# Arguments</p>
<blockquote>
<div><dl class="docutils">
<dt>weights: one of ‘pascal_voc’ (pre-trained on pascal voc)</dt>
<dd>or None (random initialization)</dd>
<dt>input_tensor: optional Keras tensor (i.e. output of <cite>layers.Input()</cite>)</dt>
<dd>to use as image input for the model.</dd>
<dt>input_shape: shape of input image. format HxWxC</dt>
<dd>PASCAL VOC model was trained on (512,512,3) images</dd>
<dt>classes: number of desired classes. If classes != 21,</dt>
<dd>last layer is initialized randomly</dd>
</dl>
<p>backbone: backbone to use. one of {‘xception’,’mobilenetv2’}
OS: determines input_shape/feature_extractor_output ratio. One of {8,16}.</p>
<blockquote>
<div>Used only for xception backbone.</div></blockquote>
<dl class="docutils">
<dt>alpha: controls the width of the MobileNetV2 network. This is known as the</dt>
<dd><dl class="first docutils">
<dt>width multiplier in the MobileNetV2 paper.</dt>
<dd><ul class="first last simple">
<li><dl class="first docutils">
<dt>If <cite>alpha</cite> &lt; 1.0, proportionally decreases the number</dt>
<dd>of filters in each layer.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If <cite>alpha</cite> &gt; 1.0, proportionally increases the number</dt>
<dd>of filters in each layer.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If <cite>alpha</cite> = 1, default number of filters from the paper</dt>
<dd>are used at each layer.</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="last">Used only for mobilenetv2 backbone</p>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt># Returns</dt>
<dd>A Keras model instance.</dd>
<dt># Raises</dt>
<dd><dl class="first docutils">
<dt>RuntimeError: If attempting to run this model with a</dt>
<dd>backend that does not support separable convolutions.</dd>
</dl>
<p class="last">ValueError: in case of invalid argument for <cite>weights</cite> or <cite>backbone</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.relu6">
<code class="descname">relu6</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/deeplabv3.html#DeeplabV3Plus.relu6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.relu6" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.build_model">
<code class="descname">build_model</code><span class="sig-paren">(</span><em>input_tensor=None</em><span class="sig-paren">)</span> &#x2192; medsegpy.modeling.model.Model<a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/deeplabv3.html#DeeplabV3Plus.build_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.deeplabv3.DeeplabV3Plus.build_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-medsegpy.modeling.meta_arch.unet">
<span id="medsegpy-modeling-meta-arch-unet"></span><h2>medsegpy.modeling.meta_arch.unet<a class="headerlink" href="#module-medsegpy.modeling.meta_arch.unet" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="medsegpy.modeling.meta_arch.unet.build_encoder_block">
<code class="descclassname">medsegpy.modeling.meta_arch.unet.</code><code class="descname">build_encoder_block</code><span class="sig-paren">(</span><em>x: tensorflow.python.framework.ops.Tensor, num_filters: Union[int, typing.Sequence[int]], kernel_size: Union[int, typing.Sequence[int]] = 3, num_conv: int = 2, activation: str = 'relu', kernel_initializer: Union[str, typing.Dict] = 'he_normal', dropout: float = 0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/medsegpy/modeling/meta_arch/unet.html#build_encoder_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#medsegpy.modeling.meta_arch.unet.build_encoder_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds simple FCN encoder block.</p>
<p>Structure is below. Where blocks in <cite>[]</cite> are repeated:</p>
<p>[Conv -&gt; Activation] -&gt; BN -&gt; Dropout.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tf.Tensor</em>) – Input tensor.</li>
<li><strong>num_filters</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em> or </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>]</em>) – Number of filters to use
for each conv layer. If a sequence, will override number of conv
layers specified by <cite>num_conv</cite>.</li>
<li><strong>kernel_size</strong> – Kernel size accepted by Keras convolution layers.</li>
<li><strong>num_conv</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – Number of convolutional blocks
(conv + activation) to use.</li>
<li><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>optional</em>) – Activation type.</li>
<li><strong>kernel_initializer</strong> – Kernel initializer accepted by
<cite>keras.layers.Conv(…)</cite>.</li>
<li><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em>, </em><em>optional</em>) – Dropout rate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><em>tf.Tensor</em> – Encoder block output.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="solver.html" class="btn btn-neutral float-right" title="medsegpy.solver" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="evaluation.html" class="btn btn-neutral float-left" title="medsegpy.evaluation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018-2021, Arjun Desai.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>